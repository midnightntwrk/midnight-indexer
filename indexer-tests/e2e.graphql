query BlockQuery($block_offset: BlockOffset) {
    block(offset: $block_offset) {
        hash
        height
        protocolVersion
        timestamp
        author
        parent {
            hash
            height
        }
        transactions {
            hash
            protocolVersion
            transactionResult {
                status
                segments {
                    id
                    success
                }
            }
            fees {
                paidFees
                estimatedFees
            }
            identifiers
            block {
                hash
            }
            contractActions {
                __typename
                ... on ContractDeploy {
                    address
                    transaction {
                        hash
                        transactionResult {
                            status
                        }
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                }
                __typename
                ... on ContractCall {
                    address
                    transaction {
                        hash
                        transactionResult {
                            status
                        }
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                    deploy {
                        address
                    }
                }
                __typename
                ... on ContractUpdate {
                    address
                    transaction {
                        transactionResult {
                            status
                        }
                        hash
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                }
            }
            unshieldedCreatedOutputs {
                owner
                value
                tokenType
                intentHash
                outputIndex
            }
            unshieldedSpentOutputs {
                owner
                value
                tokenType
                intentHash
                outputIndex
            }
        }
    }
}

query TransactionsQuery($transaction_offset: TransactionOffset!) {
    transactions(offset: $transaction_offset) {
        hash
        protocolVersion
        transactionResult {
            status
            segments {
                id
                success
            }
        }
        fees {
            paidFees
            estimatedFees
        }
        identifiers
        block {
            hash
        }
        contractActions {
            __typename
            ... on ContractDeploy {
                address
                transaction {
                    hash
                    transactionResult {
                        status
                    }
                    identifiers
                    block {
                        hash
                        height
                    }
                }
            }
            __typename
            ... on ContractCall {
                address
                transaction {
                    hash
                    transactionResult {
                        status
                    }
                    identifiers
                    block {
                        hash
                        height
                    }
                }
                deploy {
                    address
                }
            }
            __typename
            ... on ContractUpdate {
                address
                transaction {
                    hash
                    transactionResult {
                        status
                    }
                    identifiers
                    block {
                        hash
                        height
                    }
                }
            }
        }
        unshieldedCreatedOutputs {
            owner
            value
            tokenType
            intentHash
            outputIndex
        }
        unshieldedSpentOutputs {
            owner
            value
            tokenType
            intentHash
            outputIndex
        }
    }
}

query ContractActionQuery($address: HexEncoded!, $contract_action_offset: ContractActionOffset) {
    contractAction(address: $address, offset: $contract_action_offset) {
        __typename
        ... on ContractDeploy {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
        }
        __typename
        ... on ContractCall {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
            deploy {
                address
            }
        }
        __typename
        ... on ContractUpdate {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
        }
    }
}

mutation ConnectMutation($viewingKey: ViewingKey!) {
    connect(viewingKey: $viewingKey)
}

mutation DisconnectMutation($sessionId: HexEncoded!) {
    disconnect(sessionId: $sessionId)
}

subscription BlockSubscription($block_offset: BlockOffset) {
    blocks(offset: $block_offset) {
        hash
        height
        protocolVersion
        timestamp
        author
        parent {
            hash
            height
        }
        transactions {
            hash
            protocolVersion
            transactionResult {
                status
                segments {
                    id
                    success
                }
            }
            fees {
                paidFees
                estimatedFees
            }
            identifiers
            block {
                hash
            }
            contractActions {
                __typename
                ... on ContractDeploy {
                    address
                    transaction {
                        hash
                        transactionResult {
                            status
                        }
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                }
                __typename
                ... on ContractCall {
                    address
                    transaction {
                        hash
                        transactionResult {
                            status
                        }
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                    deploy {
                        address
                    }
                }
                __typename
                ... on ContractUpdate {
                    address
                    transaction {
                        hash
                        transactionResult {
                            status
                        }
                        identifiers
                        block {
                            hash
                            height
                        }
                    }
                }
            }
            unshieldedCreatedOutputs {
                owner
                value
                tokenType
                intentHash
                outputIndex
            }
            unshieldedSpentOutputs {
                owner
                value
                tokenType
                intentHash
                outputIndex
            }
        }
    }
}

subscription ContractActionSubscription(
    $address: HexEncoded!, 
    $contract_action_subscription_offset: BlockOffset
) {
    contractActions(address: $address, offset: $contract_action_subscription_offset) {
        __typename
        ... on ContractDeploy {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
        }
        __typename
        ... on ContractCall {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
            deploy {
                address
            }
        }
        __typename
        ... on ContractUpdate {
            address
            transaction {
                hash
                transactionResult {
                    status
                }
                identifiers
                block {
                    hash
                    height
                }
            }
        }
    }
}

subscription ShieldedTransactionsSubscription(
    $sessionId: HexEncoded!
) {
    shieldedTransactions(sessionId: $sessionId) {
        __typename
        ... on ViewingUpdate {
            index
            update {
                __typename
                ... on MerkleTreeCollapsedUpdate {
                    start
                    end
                }
                __typename
                ... on RelevantTransaction {
                    start
                    end
                }
            }
        }
        __typename
        ... on ShieldedTransactionsProgress {
            highestIndex
            highestRelevantIndex
            highestRelevantWalletIndex
        }
    }
}

subscription UnshieldedTransactionsSubscription($address: UnshieldedAddress!) {
    unshieldedTransactions(address: $address) {
        __typename
        ... on UnshieldedTransaction {
            transaction {
                hash
                block {
                    height
                }
            }
            createdUtxos {
                owner
                tokenType
                value
                outputIndex
                intentHash
                createdAtTransaction {
                    hash
                }
            }
            spentUtxos {
                owner
                tokenType
                value
                outputIndex
                intentHash
                createdAtTransaction {
                    hash
                }
                spentAtTransaction {
                    hash
                }
            }
        }
        __typename
        ... on UnshieldedTransactionsProgress {
            highestTransactionId
        }
    }
}

query DustEventsByTransactionQuery($transactionHash: HexEncoded!) {
    dustEventsByTransaction(transactionHash: $transactionHash) {
        transactionHash
        logicalSegment
        physicalSegment
        eventVariant
        eventAttributes {
            __typename
            ... on DustInitialUtxoDetails {
                initialValue
                owner
                nonce
                seq
                ctime
                backingNight
                mtIndex
                generationInfo {
                    nightUtxoHash
                    value
                    owner
                    nonce
                    ctime
                    dtime
                    merkleIndex
                }
            }
            __typename
            ... on DustGenerationDtimeUpdateDetails {
                generationInfo {
                    nightUtxoHash
                    value
                    owner
                    nonce
                    ctime
                    dtime
                    merkleIndex
                }
            }
            __typename
            ... on DustSpendProcessedDetails {
                commitment
                nullifier
                vFee
                time
                params {
                    nightDustRatio
                    generationDecayRate
                    dustGracePeriod
                }
            }
        }
    }
}

query RecentDustEventsQuery($limit: Int, $eventVariant: DustEventVariant) {
    recentDustEvents(limit: $limit, eventVariant: $eventVariant) {
        transactionHash
        logicalSegment
        physicalSegment
        eventVariant
        eventAttributes {
            __typename
            ... on DustInitialUtxoDetails {
                initialValue
                owner
                nonce
                seq
                ctime
                backingNight
                mtIndex
                generationInfo {
                    nightUtxoHash
                    value
                    owner
                    nonce
                    ctime
                    dtime
                    merkleIndex
                }
            }
            __typename
            ... on DustGenerationDtimeUpdateDetails {
                generationInfo {
                    nightUtxoHash
                    value
                    owner
                    nonce
                    ctime
                    dtime
                    merkleIndex
                }
            }
            __typename
            ... on DustSpendProcessedDetails {
                commitment
                nullifier
                vFee
                time
                params {
                    nightDustRatio
                    generationDecayRate
                    dustGracePeriod
                }
            }
        }
    }
}


query CurrentDustStateQuery {
    currentDustState {
        commitmentTreeRoot
        generationTreeRoot
        blockHeight
        timestamp
        totalRegistrations
    }
}

query DustMerkleRootQuery($treeType: DustMerkleTreeType!, $timestamp: Int!) {
    dustMerkleRoot(treeType: $treeType, timestamp: $timestamp)
}

query DustGenerationStatusQuery($cardanoStakeKeys: [HexEncoded!]!) {
    dustGenerationStatus(cardanoStakeKeys: $cardanoStakeKeys) {
        cardanoStakeKey
        dustAddress
        isRegistered
        generationRate
        currentCapacity
        nightBalance
    }
}

subscription DustGenerationsSubscription(
    $dustAddress: HexEncoded!,
    $fromGenerationIndex: Int,
    $fromMerkleIndex: Int,
    $onlyActive: Boolean
) {
    dustGenerations(
        dustAddress: $dustAddress,
        fromGenerationIndex: $fromGenerationIndex,
        fromMerkleIndex: $fromMerkleIndex,
        onlyActive: $onlyActive
    ) {
        __typename
        ... on DustGenerationInfo {
            nightUtxoHash
            value
            owner
            nonce
            dtime
            merkleIndex
        }
        ... on DustGenerationMerkleUpdate {
            index
            collapsedUpdate
            blockHeight
            merklePath {
                siblingHash
                goesLeft
            }
        }
        ... on DustGenerationProgress {
            highestIndex
            activeGenerationCount
        }
    }
}

subscription DustNullifierTransactionsSubscription(
    $prefixes: [HexEncoded!]!,
    $minPrefixLength: Int!,
    $fromBlock: Int
) {
    dustNullifierTransactions(
        prefixes: $prefixes,
        minPrefixLength: $minPrefixLength,
        fromBlock: $fromBlock
    ) {
        __typename
        ... on DustNullifierTransaction {
            transactionHash
            blockHeight
            matchingNullifierPrefixes
        }
        ... on DustNullifierTransactionProgress {
            highestBlock
            matchedCount
        }
    }
}

subscription DustCommitmentsSubscription(
    $commitmentPrefixes: [HexEncoded!]!,
    $startIndex: Int!,
    $minPrefixLength: Int!
) {
    dustCommitments(
        commitmentPrefixes: $commitmentPrefixes,
        startIndex: $startIndex,
        minPrefixLength: $minPrefixLength
    ) {
        __typename
        ... on DustCommitment {
            commitment
            nullifier
            value
            owner
        }
        ... on DustCommitmentMerkleUpdate {
            index
            collapsedUpdate
            blockHeight
            merklePath {
                siblingHash
                goesLeft
            }
        }
        ... on DustCommitmentProgress {
            highestIndex
            commitmentCount
        }
    }
}

subscription DustRegistrationUpdatesSubscription(
    $addresses: [RegistrationAddress!]!
) {
    dustRegistrationUpdates(addresses: $addresses) {
        __typename
        ... on RegistrationUpdate {
            cardanoStakeKey
            dustAddress
            isActive
            registeredAt
            removedAt
        }
        ... on RegistrationUpdateProgress {
            latestTimestamp
            updateCount
        }
    }
}
