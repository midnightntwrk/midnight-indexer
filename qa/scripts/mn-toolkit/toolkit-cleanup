#!/bin/bash

set -e

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Source common functions
source "$SCRIPT_DIR/toolkit-common.sh"

# Get toolkit environment (exit gracefully if none found)
ENVIRONMENT=$(get_toolkit_environment)
if [ $? -ne 0 ]; then
    echo "No toolkit container found, nothing to cleanup"
    exit 0
fi

# Validate environment
validate_environment "$ENVIRONMENT" || exit 1

CONTAINER_NAME="toolkit-${ENVIRONMENT}"

# Stop container if it's running
if docker ps --format "{{.Names}}" | grep -q "^${CONTAINER_NAME}$"; then
    echo "Stopping container $CONTAINER_NAME..."
    docker stop $CONTAINER_NAME 2>/dev/null || true
fi

# Remove container if it exists
if docker ps -a --format "{{.Names}}" | grep -q "^${CONTAINER_NAME}$"; then
    echo "Removing container $CONTAINER_NAME..."
    docker rm $CONTAINER_NAME 2>/dev/null || true
fi

echo "Cleanup complete for $CONTAINER_NAME"








