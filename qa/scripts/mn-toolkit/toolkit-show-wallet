#!/bin/bash

set -e

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

# Source common functions
source "$SCRIPT_DIR/toolkit-common.sh"

# Get toolkit environment
ENVIRONMENT=$(get_toolkit_environment) || exit 1

# Validate environment
validate_environment "$ENVIRONMENT" || exit 1

# Get network configuration
get_network_config "$ENVIRONMENT" || exit 1

SEED=$1
if [ -z "$SEED" ]; then
    echo "Please provide a seed"
    echo "Usage: $0 <seed>"
    exit 1
fi

# Use -it only if running in a TTY, otherwise just -i
if [ -t 0 ]; then
    DOCKER_FLAGS="-it"
else
    DOCKER_FLAGS="-i"
fi

docker exec $DOCKER_FLAGS toolkit-${ENVIRONMENT} \
    /midnight-node-toolkit show-wallet --help 

# Debug: print the full docker command
echo "Running: docker exec $DOCKER_FLAGS toolkit-${ENVIRONMENT} /midnight-node-toolkit show-wallet --src-url $NODE_URL --seed $SEED"
echo ""

docker exec $DOCKER_FLAGS toolkit-${ENVIRONMENT} \
    /midnight-node-toolkit show-wallet \
    --src-url $NODE_URL \
    --seed $SEED

